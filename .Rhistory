dat$BMI <- ifelse(dat$BMI == "Obese", 1, as.character(dat$BMI))
dat$Smoking <- ifelse(dat$Smoking == "No", 0, dat$Smoking)
dat$Smoking <- ifelse(dat$Smoking == "Yes", 1, dat$Smoking)
dat$AlcoholDrinking <- ifelse(dat$AlcoholDrinking == "No", 0, dat$AlcoholDrinking)
dat$AlcoholDrinking <- ifelse(dat$AlcoholDrinking == "Yes", 1, dat$AlcoholDrinking)
dat$Stroke <- ifelse(dat$Stroke == "No", 0, dat$Stroke)
dat$Stroke <- ifelse(dat$Stroke == "Yes", 1, dat$Stroke)
dat$DiffWalking <- ifelse(dat$DiffWalking == "No", 0, dat$DiffWalking)
dat$DiffWalking <- ifelse(dat$DiffWalking == "Yes", 1, dat$DiffWalking)
dat$Sex <- ifelse(dat$Sex == "Male", 0, dat$Sex)
dat$Sex <- ifelse(dat$Sex == "Female", 1, dat$Sex)
dat$AgeCategory <- ifelse(dat$AgeCategory == "18-24", 0, dat$AgeCategory)
dat$AgeCategory <- ifelse(dat$AgeCategory == "25-29", 0.08, dat$AgeCategory)
dat$AgeCategory <- ifelse(dat$AgeCategory == "30-34", 0.16, dat$AgeCategory)
dat$AgeCategory <- ifelse(dat$AgeCategory == "35-39", 0.24, dat$AgeCategory)
dat$AgeCategory <- ifelse(dat$AgeCategory == "40-44", 0.32, dat$AgeCategory)
dat$AgeCategory <- ifelse(dat$AgeCategory == "45-49", 0.4, dat$AgeCategory)
dat$AgeCategory <- ifelse(dat$AgeCategory == "50-54", 0.48, dat$AgeCategory)
dat$AgeCategory <- ifelse(dat$AgeCategory == "55-59", 0.56, dat$AgeCategory)
dat$AgeCategory <- ifelse(dat$AgeCategory == "60-64", 0.64, dat$AgeCategory)
dat$AgeCategory <- ifelse(dat$AgeCategory == "65-69", 0.72, dat$AgeCategory)
dat$AgeCategory <- ifelse(dat$AgeCategory == "70-74", 0.8, dat$AgeCategory)
dat$AgeCategory <- ifelse(dat$AgeCategory == "75-79", 0.88, dat$AgeCategory)
dat$AgeCategory <- ifelse(dat$AgeCategory == "80 or older", 1, dat$AgeCategory)
dat$Diabetic <- ifelse(dat$Diabetic == "No", 0, dat$Diabetic)
dat$Diabetic <- ifelse(dat$Diabetic == "No, borderline diabetes" | dat$Diabetic == "Yes (during pregnancy)", 0.5, dat$Diabetic)
dat$Diabetic <- ifelse(dat$Diabetic == "Yes", 1, dat$Diabetic)
dat$PhysicalActivity <- ifelse(dat$PhysicalActivity == "Male", 0, dat$PhysicalActivity)
dat$PhysicalActivity <- ifelse(dat$PhysicalActivity == "Female", 1, dat$PhysicalActivity)
dat$GenHealth <- ifelse(dat$GenHealth == "Poor", 0, dat$GenHealth)
dat$GenHealth <- ifelse(dat$GenHealth == "Fair", 0.25, dat$GenHealth)
dat$GenHealth <- ifelse(dat$GenHealth == "Good", 0.5, dat$GenHealth)
dat$GenHealth <- ifelse(dat$GenHealth == "Very good", 0.75, dat$GenHealth)
dat$GenHealth <- ifelse(dat$GenHealth == "Excellent", 1, dat$GenHealth)
dat$Asthma <- ifelse(dat$Asthma == "No", 0, dat$Asthma)
dat$Asthma <- ifelse(dat$Asthma == "Yes", 1, dat$Asthma)
dat$KidneyDisease <- ifelse(dat$KidneyDisease == "No", 0, dat$KidneyDisease)
dat$KidneyDisease <- ifelse(dat$KidneyDisease == "Yes", 1, dat$KidneyDisease)
dat$SkinCancer <- ifelse(dat$SkinCancer == "No", 0, dat$SkinCancer)
dat$SkinCancer <- ifelse(dat$SkinCancer == "Yes", 1, dat$SkinCancer)
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(readxl)
library(factoextra)
dat = read.csv("heart_2020_cleaned.csv")
#dat = dat %>% mutate_if(is.character, factor)
dat <- subset(dat, select = -c(Race))
dat$BMI <- cut(dat$BMI, breaks=c(0, 18.5, 25, 30, +Inf),
labels=c("Underweight", "Normal", "Overweight", "Obese"))
dat$HeartDisease <- ifelse(dat$HeartDisease == "No", 0, dat$HeartDisease)
dat$HeartDisease <- ifelse(dat$HeartDisease == "Yes", 1, dat$HeartDisease)
dat$BMI <- ifelse(dat$BMI == "Underweight", 0, as.character(dat$BMI))
dat$BMI <- ifelse(dat$BMI == "Normal", 0.33, as.character(dat$BMI))
dat$BMI <- ifelse(dat$BMI == "Overweight", 0.66, as.character(dat$BMI))
dat$BMI <- ifelse(dat$BMI == "Obese", 1, as.character(dat$BMI))
dat$Smoking <- ifelse(dat$Smoking == "No", 0, dat$Smoking)
dat$Smoking <- ifelse(dat$Smoking == "Yes", 1, dat$Smoking)
dat$AlcoholDrinking <- ifelse(dat$AlcoholDrinking == "No", 0, dat$AlcoholDrinking)
dat$AlcoholDrinking <- ifelse(dat$AlcoholDrinking == "Yes", 1, dat$AlcoholDrinking)
dat$Stroke <- ifelse(dat$Stroke == "No", 0, dat$Stroke)
dat$Stroke <- ifelse(dat$Stroke == "Yes", 1, dat$Stroke)
dat$DiffWalking <- ifelse(dat$DiffWalking == "No", 0, dat$DiffWalking)
dat$DiffWalking <- ifelse(dat$DiffWalking == "Yes", 1, dat$DiffWalking)
dat$Sex <- ifelse(dat$Sex == "Male", 0, dat$Sex)
dat$Sex <- ifelse(dat$Sex == "Female", 1, dat$Sex)
dat$AgeCategory <- ifelse(dat$AgeCategory == "18-24", 0, dat$AgeCategory)
dat$AgeCategory <- ifelse(dat$AgeCategory == "25-29", 0.08, dat$AgeCategory)
dat$AgeCategory <- ifelse(dat$AgeCategory == "30-34", 0.16, dat$AgeCategory)
dat$AgeCategory <- ifelse(dat$AgeCategory == "35-39", 0.24, dat$AgeCategory)
dat$AgeCategory <- ifelse(dat$AgeCategory == "40-44", 0.32, dat$AgeCategory)
dat$AgeCategory <- ifelse(dat$AgeCategory == "45-49", 0.4, dat$AgeCategory)
dat$AgeCategory <- ifelse(dat$AgeCategory == "50-54", 0.48, dat$AgeCategory)
dat$AgeCategory <- ifelse(dat$AgeCategory == "55-59", 0.56, dat$AgeCategory)
dat$AgeCategory <- ifelse(dat$AgeCategory == "60-64", 0.64, dat$AgeCategory)
dat$AgeCategory <- ifelse(dat$AgeCategory == "65-69", 0.72, dat$AgeCategory)
dat$AgeCategory <- ifelse(dat$AgeCategory == "70-74", 0.8, dat$AgeCategory)
dat$AgeCategory <- ifelse(dat$AgeCategory == "75-79", 0.88, dat$AgeCategory)
dat$AgeCategory <- ifelse(dat$AgeCategory == "80 or older", 1, dat$AgeCategory)
dat$Diabetic <- ifelse(dat$Diabetic == "No", 0, dat$Diabetic)
dat$Diabetic <- ifelse(dat$Diabetic == "No, borderline diabetes" | dat$Diabetic == "Yes (during pregnancy)", 0.5, dat$Diabetic)
dat$Diabetic <- ifelse(dat$Diabetic == "Yes", 1, dat$Diabetic)
dat$PhysicalActivity <- ifelse(dat$PhysicalActivity == "No", 0, dat$PhysicalActivity)
dat$PhysicalActivity <- ifelse(dat$PhysicalActivity == "Yes", 1, dat$PhysicalActivity)
dat$GenHealth <- ifelse(dat$GenHealth == "Poor", 0, dat$GenHealth)
dat$GenHealth <- ifelse(dat$GenHealth == "Fair", 0.25, dat$GenHealth)
dat$GenHealth <- ifelse(dat$GenHealth == "Good", 0.5, dat$GenHealth)
dat$GenHealth <- ifelse(dat$GenHealth == "Very good", 0.75, dat$GenHealth)
dat$GenHealth <- ifelse(dat$GenHealth == "Excellent", 1, dat$GenHealth)
dat$Asthma <- ifelse(dat$Asthma == "No", 0, dat$Asthma)
dat$Asthma <- ifelse(dat$Asthma == "Yes", 1, dat$Asthma)
dat$KidneyDisease <- ifelse(dat$KidneyDisease == "No", 0, dat$KidneyDisease)
dat$KidneyDisease <- ifelse(dat$KidneyDisease == "Yes", 1, dat$KidneyDisease)
dat$SkinCancer <- ifelse(dat$SkinCancer == "No", 0, dat$SkinCancer)
dat$SkinCancer <- ifelse(dat$SkinCancer == "Yes", 1, dat$SkinCancer)
clusters <- kmeans(x=dat, centers=2, nstart = 2)
clusters <- kmeans(x=dat, centers=2, nstart = 2)
print(clusters)
initialCenters <- dat[c(1, 6), ]
clusters <- kmeans(x=dat, centers=initialCenters, nstart = 2)
print(clusters)
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(readxl)
library(factoextra)
dat = read.csv("heart_2020_cleaned.csv")
#dat = dat %>% mutate_if(is.character, factor)
dat <- subset(dat, select = -c(Race))
dat$BMI <- cut(dat$BMI, breaks=c(0, 18.5, 25, 30, +Inf),
labels=c("Underweight", "Normal", "Overweight", "Obese"))
dat <- dat[!duplicated(dat), ]
dat$HeartDisease <- ifelse(dat$HeartDisease == "No", 0, dat$HeartDisease)
dat$HeartDisease <- ifelse(dat$HeartDisease == "Yes", 1, dat$HeartDisease)
dat$BMI <- ifelse(dat$BMI == "Underweight", 0, as.character(dat$BMI))
dat$BMI <- ifelse(dat$BMI == "Normal", 0.33, as.character(dat$BMI))
dat$BMI <- ifelse(dat$BMI == "Overweight", 0.66, as.character(dat$BMI))
dat$BMI <- ifelse(dat$BMI == "Obese", 1, as.character(dat$BMI))
dat$Smoking <- ifelse(dat$Smoking == "No", 0, dat$Smoking)
dat$Smoking <- ifelse(dat$Smoking == "Yes", 1, dat$Smoking)
dat$AlcoholDrinking <- ifelse(dat$AlcoholDrinking == "No", 0, dat$AlcoholDrinking)
dat$AlcoholDrinking <- ifelse(dat$AlcoholDrinking == "Yes", 1, dat$AlcoholDrinking)
dat$Stroke <- ifelse(dat$Stroke == "No", 0, dat$Stroke)
dat$Stroke <- ifelse(dat$Stroke == "Yes", 1, dat$Stroke)
dat$DiffWalking <- ifelse(dat$DiffWalking == "No", 0, dat$DiffWalking)
dat$DiffWalking <- ifelse(dat$DiffWalking == "Yes", 1, dat$DiffWalking)
dat$Sex <- ifelse(dat$Sex == "Male", 0, dat$Sex)
dat$Sex <- ifelse(dat$Sex == "Female", 1, dat$Sex)
dat$AgeCategory <- ifelse(dat$AgeCategory == "18-24", 0, dat$AgeCategory)
dat$AgeCategory <- ifelse(dat$AgeCategory == "25-29", 0.08, dat$AgeCategory)
dat$AgeCategory <- ifelse(dat$AgeCategory == "30-34", 0.16, dat$AgeCategory)
dat$AgeCategory <- ifelse(dat$AgeCategory == "35-39", 0.24, dat$AgeCategory)
dat$AgeCategory <- ifelse(dat$AgeCategory == "40-44", 0.32, dat$AgeCategory)
dat$AgeCategory <- ifelse(dat$AgeCategory == "45-49", 0.4, dat$AgeCategory)
dat$AgeCategory <- ifelse(dat$AgeCategory == "50-54", 0.48, dat$AgeCategory)
dat$AgeCategory <- ifelse(dat$AgeCategory == "55-59", 0.56, dat$AgeCategory)
dat$AgeCategory <- ifelse(dat$AgeCategory == "60-64", 0.64, dat$AgeCategory)
dat$AgeCategory <- ifelse(dat$AgeCategory == "65-69", 0.72, dat$AgeCategory)
dat$AgeCategory <- ifelse(dat$AgeCategory == "70-74", 0.8, dat$AgeCategory)
dat$AgeCategory <- ifelse(dat$AgeCategory == "75-79", 0.88, dat$AgeCategory)
dat$AgeCategory <- ifelse(dat$AgeCategory == "80 or older", 1, dat$AgeCategory)
dat$Diabetic <- ifelse(dat$Diabetic == "No", 0, dat$Diabetic)
dat$Diabetic <- ifelse(dat$Diabetic == "No, borderline diabetes" | dat$Diabetic == "Yes (during pregnancy)", 0.5, dat$Diabetic)
dat$Diabetic <- ifelse(dat$Diabetic == "Yes", 1, dat$Diabetic)
dat$PhysicalActivity <- ifelse(dat$PhysicalActivity == "No", 0, dat$PhysicalActivity)
dat$PhysicalActivity <- ifelse(dat$PhysicalActivity == "Yes", 1, dat$PhysicalActivity)
dat$GenHealth <- ifelse(dat$GenHealth == "Poor", 0, dat$GenHealth)
dat$GenHealth <- ifelse(dat$GenHealth == "Fair", 0.25, dat$GenHealth)
dat$GenHealth <- ifelse(dat$GenHealth == "Good", 0.5, dat$GenHealth)
dat$GenHealth <- ifelse(dat$GenHealth == "Very good", 0.75, dat$GenHealth)
dat$GenHealth <- ifelse(dat$GenHealth == "Excellent", 1, dat$GenHealth)
dat$Asthma <- ifelse(dat$Asthma == "No", 0, dat$Asthma)
dat$Asthma <- ifelse(dat$Asthma == "Yes", 1, dat$Asthma)
dat$KidneyDisease <- ifelse(dat$KidneyDisease == "No", 0, dat$KidneyDisease)
dat$KidneyDisease <- ifelse(dat$KidneyDisease == "Yes", 1, dat$KidneyDisease)
dat$SkinCancer <- ifelse(dat$SkinCancer == "No", 0, dat$SkinCancer)
dat$SkinCancer <- ifelse(dat$SkinCancer == "Yes", 1, dat$SkinCancer)
initialCenters <- dat[c(1, 6), ]
clusters <- kmeans(x=dat, centers=initialCenters, nstart = 2)
print(clusters)
clusters <- kmeans(x=dat, centers=2, nstart = 2)
print(clusters)
clusters <- kmeans(x=dat, centers=3, nstart = 2)
print(clusters)
clusters <- kmeans(x=dat, centers=4, nstart = 2)
print(clusters)
dat = read.csv("heart_2020_cleaned.csv")
#dat = dat %>% mutate_if(is.character, factor)
dat <- dat[!duplicated(dat), ]
dat <- subset(dat, select = -c(Race))
dat$BMI <- cut(dat$BMI, breaks=c(0, 18.5, 25, 30, +Inf),
labels=c("Underweight", "Normal", "Overweight", "Obese"))
dat$HeartDisease <- ifelse(dat$HeartDisease == "No", 0, dat$HeartDisease)
dat$HeartDisease <- ifelse(dat$HeartDisease == "Yes", 1, dat$HeartDisease)
dat$BMI <- ifelse(dat$BMI == "Underweight", 0, as.character(dat$BMI))
dat$BMI <- ifelse(dat$BMI == "Normal", 0.33, as.character(dat$BMI))
dat$BMI <- ifelse(dat$BMI == "Overweight", 0.66, as.character(dat$BMI))
dat$BMI <- ifelse(dat$BMI == "Obese", 1, as.character(dat$BMI))
dat$Smoking <- ifelse(dat$Smoking == "No", 0, dat$Smoking)
dat$Smoking <- ifelse(dat$Smoking == "Yes", 1, dat$Smoking)
dat$AlcoholDrinking <- ifelse(dat$AlcoholDrinking == "No", 0, dat$AlcoholDrinking)
dat$AlcoholDrinking <- ifelse(dat$AlcoholDrinking == "Yes", 1, dat$AlcoholDrinking)
dat$Stroke <- ifelse(dat$Stroke == "No", 0, dat$Stroke)
dat$Stroke <- ifelse(dat$Stroke == "Yes", 1, dat$Stroke)
dat$DiffWalking <- ifelse(dat$DiffWalking == "No", 0, dat$DiffWalking)
dat$DiffWalking <- ifelse(dat$DiffWalking == "Yes", 1, dat$DiffWalking)
dat$Sex <- ifelse(dat$Sex == "Male", 0, dat$Sex)
dat$Sex <- ifelse(dat$Sex == "Female", 1, dat$Sex)
dat$AgeCategory <- ifelse(dat$AgeCategory == "18-24", 0, dat$AgeCategory)
dat$AgeCategory <- ifelse(dat$AgeCategory == "25-29", 0.08, dat$AgeCategory)
dat$AgeCategory <- ifelse(dat$AgeCategory == "30-34", 0.16, dat$AgeCategory)
dat$AgeCategory <- ifelse(dat$AgeCategory == "35-39", 0.24, dat$AgeCategory)
dat$AgeCategory <- ifelse(dat$AgeCategory == "40-44", 0.32, dat$AgeCategory)
dat$AgeCategory <- ifelse(dat$AgeCategory == "45-49", 0.4, dat$AgeCategory)
dat$AgeCategory <- ifelse(dat$AgeCategory == "50-54", 0.48, dat$AgeCategory)
dat$AgeCategory <- ifelse(dat$AgeCategory == "55-59", 0.56, dat$AgeCategory)
dat$AgeCategory <- ifelse(dat$AgeCategory == "60-64", 0.64, dat$AgeCategory)
dat$AgeCategory <- ifelse(dat$AgeCategory == "65-69", 0.72, dat$AgeCategory)
dat$AgeCategory <- ifelse(dat$AgeCategory == "70-74", 0.8, dat$AgeCategory)
dat$AgeCategory <- ifelse(dat$AgeCategory == "75-79", 0.88, dat$AgeCategory)
dat$AgeCategory <- ifelse(dat$AgeCategory == "80 or older", 1, dat$AgeCategory)
dat$Diabetic <- ifelse(dat$Diabetic == "No", 0, dat$Diabetic)
dat$Diabetic <- ifelse(dat$Diabetic == "No, borderline diabetes" | dat$Diabetic == "Yes (during pregnancy)", 0.5, dat$Diabetic)
dat$Diabetic <- ifelse(dat$Diabetic == "Yes", 1, dat$Diabetic)
dat$PhysicalActivity <- ifelse(dat$PhysicalActivity == "No", 0, dat$PhysicalActivity)
dat$PhysicalActivity <- ifelse(dat$PhysicalActivity == "Yes", 1, dat$PhysicalActivity)
dat$GenHealth <- ifelse(dat$GenHealth == "Poor", 0, dat$GenHealth)
dat$GenHealth <- ifelse(dat$GenHealth == "Fair", 0.25, dat$GenHealth)
dat$GenHealth <- ifelse(dat$GenHealth == "Good", 0.5, dat$GenHealth)
dat$GenHealth <- ifelse(dat$GenHealth == "Very good", 0.75, dat$GenHealth)
dat$GenHealth <- ifelse(dat$GenHealth == "Excellent", 1, dat$GenHealth)
dat$Asthma <- ifelse(dat$Asthma == "No", 0, dat$Asthma)
dat$Asthma <- ifelse(dat$Asthma == "Yes", 1, dat$Asthma)
dat$KidneyDisease <- ifelse(dat$KidneyDisease == "No", 0, dat$KidneyDisease)
dat$KidneyDisease <- ifelse(dat$KidneyDisease == "Yes", 1, dat$KidneyDisease)
dat$SkinCancer <- ifelse(dat$SkinCancer == "No", 0, dat$SkinCancer)
dat$SkinCancer <- ifelse(dat$SkinCancer == "Yes", 1, dat$SkinCancer)
clusters <- kmeans(x=dat, centers=2, nstart = 2)
print(clusters)
clusters <- kmeans(x=dat, centers=1, nstart = 2)
print(clusters)
clusters <- kmeans(x=dat, centers=2, nstart = 100)
print(clusters)
clusters <- kmeans(x=dat, centers=2, nstart = 1000)
print(clusters)
clusters <- kmeans(x=dat, centers=2, nstart = 10000)
print(clusters)
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(readxl)
library(factoextra)
dat = read.csv("heart_2020_cleaned.csv")
#dat = dat %>% mutate_if(is.character, factor)
dat <- dat[!duplicated(dat), ]
dat <- subset(dat, select = -c(Race))
dat$BMI <- cut(dat$BMI, breaks=c(0, 18.5, 25, 30, +Inf),
labels=c("Underweight", "Normal", "Overweight", "Obese"))
dat$HeartDisease <- ifelse(dat$HeartDisease == "No", 0, dat$HeartDisease)
dat$HeartDisease <- ifelse(dat$HeartDisease == "Yes", 1, dat$HeartDisease)
dat$BMI <- ifelse(dat$BMI == "Underweight", 0, as.character(dat$BMI))
dat$BMI <- ifelse(dat$BMI == "Normal", 1, as.character(dat$BMI))
dat$BMI <- ifelse(dat$BMI == "Overweight", 2, as.character(dat$BMI))
dat$BMI <- ifelse(dat$BMI == "Obese", 3, as.character(dat$BMI))
dat$Smoking <- ifelse(dat$Smoking == "No", 0, dat$Smoking)
dat$Smoking <- ifelse(dat$Smoking == "Yes", 1, dat$Smoking)
dat$AlcoholDrinking <- ifelse(dat$AlcoholDrinking == "No", 0, dat$AlcoholDrinking)
dat$AlcoholDrinking <- ifelse(dat$AlcoholDrinking == "Yes", 1, dat$AlcoholDrinking)
dat$Stroke <- ifelse(dat$Stroke == "No", 0, dat$Stroke)
dat$Stroke <- ifelse(dat$Stroke == "Yes", 1, dat$Stroke)
dat$DiffWalking <- ifelse(dat$DiffWalking == "No", 0, dat$DiffWalking)
dat$DiffWalking <- ifelse(dat$DiffWalking == "Yes", 1, dat$DiffWalking)
dat$Sex <- ifelse(dat$Sex == "Male", 0, dat$Sex)
dat$Sex <- ifelse(dat$Sex == "Female", 1, dat$Sex)
dat$AgeCategory <- ifelse(dat$AgeCategory == "18-24", 0, dat$AgeCategory)
dat$AgeCategory <- ifelse(dat$AgeCategory == "25-29", 1, dat$AgeCategory)
dat$AgeCategory <- ifelse(dat$AgeCategory == "30-34", 2, dat$AgeCategory)
dat$AgeCategory <- ifelse(dat$AgeCategory == "35-39", 3, dat$AgeCategory)
dat$AgeCategory <- ifelse(dat$AgeCategory == "40-44", 4, dat$AgeCategory)
dat$AgeCategory <- ifelse(dat$AgeCategory == "45-49", 5, dat$AgeCategory)
dat$AgeCategory <- ifelse(dat$AgeCategory == "50-54", 6, dat$AgeCategory)
dat$AgeCategory <- ifelse(dat$AgeCategory == "55-59", 7, dat$AgeCategory)
dat$AgeCategory <- ifelse(dat$AgeCategory == "60-64", 8, dat$AgeCategory)
dat$AgeCategory <- ifelse(dat$AgeCategory == "65-69", 9, dat$AgeCategory)
dat$AgeCategory <- ifelse(dat$AgeCategory == "70-74", 10, dat$AgeCategory)
dat$AgeCategory <- ifelse(dat$AgeCategory == "75-79", 11, dat$AgeCategory)
dat$AgeCategory <- ifelse(dat$AgeCategory == "80 or older", 12, dat$AgeCategory)
dat$Diabetic <- ifelse(dat$Diabetic == "No", 0, dat$Diabetic)
dat$Diabetic <- ifelse(dat$Diabetic == "No, borderline diabetes" | dat$Diabetic == "Yes (during pregnancy)", 0.5, dat$Diabetic)
dat$Diabetic <- ifelse(dat$Diabetic == "Yes", 1, dat$Diabetic)
dat$PhysicalActivity <- ifelse(dat$PhysicalActivity == "No", 0, dat$PhysicalActivity)
dat$PhysicalActivity <- ifelse(dat$PhysicalActivity == "Yes", 1, dat$PhysicalActivity)
dat$GenHealth <- ifelse(dat$GenHealth == "Poor", 0, dat$GenHealth)
dat$GenHealth <- ifelse(dat$GenHealth == "Fair", 0.25, dat$GenHealth)
dat$GenHealth <- ifelse(dat$GenHealth == "Good", 0.5, dat$GenHealth)
dat$GenHealth <- ifelse(dat$GenHealth == "Very good", 0.75, dat$GenHealth)
dat$GenHealth <- ifelse(dat$GenHealth == "Excellent", 1, dat$GenHealth)
dat$Asthma <- ifelse(dat$Asthma == "No", 0, dat$Asthma)
dat$Asthma <- ifelse(dat$Asthma == "Yes", 1, dat$Asthma)
dat$KidneyDisease <- ifelse(dat$KidneyDisease == "No", 0, dat$KidneyDisease)
dat$KidneyDisease <- ifelse(dat$KidneyDisease == "Yes", 1, dat$KidneyDisease)
dat$SkinCancer <- ifelse(dat$SkinCancer == "No", 0, dat$SkinCancer)
dat$SkinCancer <- ifelse(dat$SkinCancer == "Yes", 1, dat$SkinCancer)
clusters <- kmeans(x=dat, centers=2, nstart = 1000)
print(clusters)
dat <- subset(dat, select = -c(AlcoholDrinking))
clusters <- kmeans(x=dat, centers=2, nstart = 1000)
print(clusters)
dat <- subset(dat, select = -c(AlcoholDrinking))
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(readxl)
library(factoextra)
dat = read.csv("heart_2020_cleaned.csv")
#dat = dat %>% mutate_if(is.character, factor)
dat <- dat[!duplicated(dat), ]
dat <- subset(dat, select = -c(Race))
dat$BMI <- cut(dat$BMI, breaks=c(0, 18.5, 25, 30, +Inf),
labels=c("Underweight", "Normal", "Overweight", "Obese"))
dat$HeartDisease <- ifelse(dat$HeartDisease == "No", 0, dat$HeartDisease)
dat$HeartDisease <- ifelse(dat$HeartDisease == "Yes", 1, dat$HeartDisease)
dat$BMI <- ifelse(dat$BMI == "Underweight", 0, as.character(dat$BMI))
dat$BMI <- ifelse(dat$BMI == "Normal", 1, as.character(dat$BMI))
dat$BMI <- ifelse(dat$BMI == "Overweight", 2, as.character(dat$BMI))
dat$BMI <- ifelse(dat$BMI == "Obese", 3, as.character(dat$BMI))
dat$Smoking <- ifelse(dat$Smoking == "No", 0, dat$Smoking)
dat$Smoking <- ifelse(dat$Smoking == "Yes", 1, dat$Smoking)
dat$AlcoholDrinking <- ifelse(dat$AlcoholDrinking == "No", 0, dat$AlcoholDrinking)
dat$AlcoholDrinking <- ifelse(dat$AlcoholDrinking == "Yes", 1, dat$AlcoholDrinking)
dat$Stroke <- ifelse(dat$Stroke == "No", 0, dat$Stroke)
dat$Stroke <- ifelse(dat$Stroke == "Yes", 1, dat$Stroke)
dat$DiffWalking <- ifelse(dat$DiffWalking == "No", 0, dat$DiffWalking)
dat$DiffWalking <- ifelse(dat$DiffWalking == "Yes", 1, dat$DiffWalking)
dat$Sex <- ifelse(dat$Sex == "Male", 0, dat$Sex)
dat$Sex <- ifelse(dat$Sex == "Female", 1, dat$Sex)
dat$AgeCategory <- ifelse(dat$AgeCategory == "18-24", 0, dat$AgeCategory)
dat$AgeCategory <- ifelse(dat$AgeCategory == "25-29", 1, dat$AgeCategory)
dat$AgeCategory <- ifelse(dat$AgeCategory == "30-34", 2, dat$AgeCategory)
dat$AgeCategory <- ifelse(dat$AgeCategory == "35-39", 3, dat$AgeCategory)
dat$AgeCategory <- ifelse(dat$AgeCategory == "40-44", 4, dat$AgeCategory)
dat$AgeCategory <- ifelse(dat$AgeCategory == "45-49", 5, dat$AgeCategory)
dat$AgeCategory <- ifelse(dat$AgeCategory == "50-54", 6, dat$AgeCategory)
dat$AgeCategory <- ifelse(dat$AgeCategory == "55-59", 7, dat$AgeCategory)
dat$AgeCategory <- ifelse(dat$AgeCategory == "60-64", 8, dat$AgeCategory)
dat$AgeCategory <- ifelse(dat$AgeCategory == "65-69", 9, dat$AgeCategory)
dat$AgeCategory <- ifelse(dat$AgeCategory == "70-74", 10, dat$AgeCategory)
dat$AgeCategory <- ifelse(dat$AgeCategory == "75-79", 11, dat$AgeCategory)
dat$AgeCategory <- ifelse(dat$AgeCategory == "80 or older", 12, dat$AgeCategory)
dat$Diabetic <- ifelse(dat$Diabetic == "No", 0, dat$Diabetic)
dat$Diabetic <- ifelse(dat$Diabetic == "No, borderline diabetes" | dat$Diabetic == "Yes (during pregnancy)", 0.5, dat$Diabetic)
dat$Diabetic <- ifelse(dat$Diabetic == "Yes", 1, dat$Diabetic)
dat$PhysicalActivity <- ifelse(dat$PhysicalActivity == "No", 0, dat$PhysicalActivity)
dat$PhysicalActivity <- ifelse(dat$PhysicalActivity == "Yes", 1, dat$PhysicalActivity)
dat$GenHealth <- ifelse(dat$GenHealth == "Poor", 0, dat$GenHealth)
dat$GenHealth <- ifelse(dat$GenHealth == "Fair", 0.25, dat$GenHealth)
dat$GenHealth <- ifelse(dat$GenHealth == "Good", 0.5, dat$GenHealth)
dat$GenHealth <- ifelse(dat$GenHealth == "Very good", 0.75, dat$GenHealth)
dat$GenHealth <- ifelse(dat$GenHealth == "Excellent", 1, dat$GenHealth)
dat$Asthma <- ifelse(dat$Asthma == "No", 0, dat$Asthma)
dat$Asthma <- ifelse(dat$Asthma == "Yes", 1, dat$Asthma)
dat$KidneyDisease <- ifelse(dat$KidneyDisease == "No", 0, dat$KidneyDisease)
dat$KidneyDisease <- ifelse(dat$KidneyDisease == "Yes", 1, dat$KidneyDisease)
dat$SkinCancer <- ifelse(dat$SkinCancer == "No", 0, dat$SkinCancer)
dat$SkinCancer <- ifelse(dat$SkinCancer == "Yes", 1, dat$SkinCancer)
dat <- subset(dat, select = -c(AlcoholDrinking))
clusters <- kmeans(x=dat, centers=2, nstart = 1000)
print(clusters)
print(clusters$centers)
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(readxl)
library(factoextra)
dat = read.csv("heart_2020_cleaned.csv")
#dat = dat %>% mutate_if(is.character, factor)
dat <- dat[!duplicated(dat), ]
dat <- subset(dat, select = -c(Race))
dat$BMI <- cut(dat$BMI, breaks=c(0, 18.5, 25, 30, +Inf),
labels=c("Underweight", "Normal", "Overweight", "Obese"))
dat$HeartDisease <- ifelse(dat$HeartDisease == "No", 0, dat$HeartDisease)
dat$HeartDisease <- ifelse(dat$HeartDisease == "Yes", 1, dat$HeartDisease)
dat$BMI <- ifelse(dat$BMI == "Underweight", 0, as.character(dat$BMI))
dat$BMI <- ifelse(dat$BMI == "Normal", 1, as.character(dat$BMI))
dat$BMI <- ifelse(dat$BMI == "Overweight", 2, as.character(dat$BMI))
dat$BMI <- ifelse(dat$BMI == "Obese", 3, as.character(dat$BMI))
dat$Smoking <- ifelse(dat$Smoking == "No", 0, dat$Smoking)
dat$Smoking <- ifelse(dat$Smoking == "Yes", 1, dat$Smoking)
dat$AlcoholDrinking <- ifelse(dat$AlcoholDrinking == "No", 0, dat$AlcoholDrinking)
dat$AlcoholDrinking <- ifelse(dat$AlcoholDrinking == "Yes", 1, dat$AlcoholDrinking)
dat$Stroke <- ifelse(dat$Stroke == "No", 0, dat$Stroke)
dat$Stroke <- ifelse(dat$Stroke == "Yes", 1, dat$Stroke)
dat$DiffWalking <- ifelse(dat$DiffWalking == "No", 0, dat$DiffWalking)
dat$DiffWalking <- ifelse(dat$DiffWalking == "Yes", 1, dat$DiffWalking)
dat$Sex <- ifelse(dat$Sex == "Male", 0, dat$Sex)
dat$Sex <- ifelse(dat$Sex == "Female", 1, dat$Sex)
dat$AgeCategory <- ifelse(dat$AgeCategory == "18-24", 0, dat$AgeCategory)
dat$AgeCategory <- ifelse(dat$AgeCategory == "25-29", 1, dat$AgeCategory)
dat$AgeCategory <- ifelse(dat$AgeCategory == "30-34", 2, dat$AgeCategory)
dat$AgeCategory <- ifelse(dat$AgeCategory == "35-39", 3, dat$AgeCategory)
dat$AgeCategory <- ifelse(dat$AgeCategory == "40-44", 4, dat$AgeCategory)
dat$AgeCategory <- ifelse(dat$AgeCategory == "45-49", 5, dat$AgeCategory)
dat$AgeCategory <- ifelse(dat$AgeCategory == "50-54", 6, dat$AgeCategory)
dat$AgeCategory <- ifelse(dat$AgeCategory == "55-59", 7, dat$AgeCategory)
dat$AgeCategory <- ifelse(dat$AgeCategory == "60-64", 8, dat$AgeCategory)
dat$AgeCategory <- ifelse(dat$AgeCategory == "65-69", 9, dat$AgeCategory)
dat$AgeCategory <- ifelse(dat$AgeCategory == "70-74", 10, dat$AgeCategory)
dat$AgeCategory <- ifelse(dat$AgeCategory == "75-79", 11, dat$AgeCategory)
dat$AgeCategory <- ifelse(dat$AgeCategory == "80 or older", 12, dat$AgeCategory)
dat$Diabetic <- ifelse(dat$Diabetic == "No", 0, dat$Diabetic)
dat$Diabetic <- ifelse(dat$Diabetic == "No, borderline diabetes" | dat$Diabetic == "Yes (during pregnancy)", 0.5, dat$Diabetic)
dat$Diabetic <- ifelse(dat$Diabetic == "Yes", 1, dat$Diabetic)
dat$PhysicalActivity <- ifelse(dat$PhysicalActivity == "No", 0, dat$PhysicalActivity)
dat$PhysicalActivity <- ifelse(dat$PhysicalActivity == "Yes", 1, dat$PhysicalActivity)
dat$GenHealth <- ifelse(dat$GenHealth == "Poor", 0, dat$GenHealth)
dat$GenHealth <- ifelse(dat$GenHealth == "Fair", 0.25, dat$GenHealth)
dat$GenHealth <- ifelse(dat$GenHealth == "Good", 0.5, dat$GenHealth)
dat$GenHealth <- ifelse(dat$GenHealth == "Very good", 0.75, dat$GenHealth)
dat$GenHealth <- ifelse(dat$GenHealth == "Excellent", 1, dat$GenHealth)
dat$Asthma <- ifelse(dat$Asthma == "No", 0, dat$Asthma)
dat$Asthma <- ifelse(dat$Asthma == "Yes", 1, dat$Asthma)
dat$KidneyDisease <- ifelse(dat$KidneyDisease == "No", 0, dat$KidneyDisease)
dat$KidneyDisease <- ifelse(dat$KidneyDisease == "Yes", 1, dat$KidneyDisease)
dat$SkinCancer <- ifelse(dat$SkinCancer == "No", 0, dat$SkinCancer)
dat$SkinCancer <- ifelse(dat$SkinCancer == "Yes", 1, dat$SkinCancer)
dat <- subset(dat, select = -c(AlcoholDrinking))
trainingSet <- dat %>% filter(row(dat) >= 1 & row(dat) <= 200000)
testingSet <- dat %>% filter(row(dat) >= 200001 & row(dat) <= 301717)
clusters <- kmeans(x=trainingSet, centers=2, nstart = 1000)
print(clusters)
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(readxl)
library(factoextra)
dat = read.csv("heart_2020_cleaned.csv")
#dat = dat %>% mutate_if(is.character, factor)
dat <- dat[!duplicated(dat), ]
dat <- subset(dat, select = -c(Race))
dat$BMI <- cut(dat$BMI, breaks=c(0, 18.5, 25, 30, +Inf),
labels=c("Underweight", "Normal", "Overweight", "Obese"))
dat$HeartDisease <- ifelse(dat$HeartDisease == "No", 0, dat$HeartDisease)
dat$HeartDisease <- ifelse(dat$HeartDisease == "Yes", 1, dat$HeartDisease)
dat$BMI <- ifelse(dat$BMI == "Underweight", 0, as.character(dat$BMI))
dat$BMI <- ifelse(dat$BMI == "Normal", 1, as.character(dat$BMI))
dat$BMI <- ifelse(dat$BMI == "Overweight", 2, as.character(dat$BMI))
dat$BMI <- ifelse(dat$BMI == "Obese", 3, as.character(dat$BMI))
dat$Smoking <- ifelse(dat$Smoking == "No", 0, dat$Smoking)
dat$Smoking <- ifelse(dat$Smoking == "Yes", 1, dat$Smoking)
dat$AlcoholDrinking <- ifelse(dat$AlcoholDrinking == "No", 0, dat$AlcoholDrinking)
dat$AlcoholDrinking <- ifelse(dat$AlcoholDrinking == "Yes", 1, dat$AlcoholDrinking)
dat$Stroke <- ifelse(dat$Stroke == "No", 0, dat$Stroke)
dat$Stroke <- ifelse(dat$Stroke == "Yes", 1, dat$Stroke)
dat$DiffWalking <- ifelse(dat$DiffWalking == "No", 0, dat$DiffWalking)
dat$DiffWalking <- ifelse(dat$DiffWalking == "Yes", 1, dat$DiffWalking)
dat$Sex <- ifelse(dat$Sex == "Male", 0, dat$Sex)
dat$Sex <- ifelse(dat$Sex == "Female", 1, dat$Sex)
dat$AgeCategory <- ifelse(dat$AgeCategory == "18-24", 0, dat$AgeCategory)
dat$AgeCategory <- ifelse(dat$AgeCategory == "25-29", 1, dat$AgeCategory)
dat$AgeCategory <- ifelse(dat$AgeCategory == "30-34", 2, dat$AgeCategory)
dat$AgeCategory <- ifelse(dat$AgeCategory == "35-39", 3, dat$AgeCategory)
dat$AgeCategory <- ifelse(dat$AgeCategory == "40-44", 4, dat$AgeCategory)
dat$AgeCategory <- ifelse(dat$AgeCategory == "45-49", 5, dat$AgeCategory)
dat$AgeCategory <- ifelse(dat$AgeCategory == "50-54", 6, dat$AgeCategory)
dat$AgeCategory <- ifelse(dat$AgeCategory == "55-59", 7, dat$AgeCategory)
dat$AgeCategory <- ifelse(dat$AgeCategory == "60-64", 8, dat$AgeCategory)
dat$AgeCategory <- ifelse(dat$AgeCategory == "65-69", 9, dat$AgeCategory)
dat$AgeCategory <- ifelse(dat$AgeCategory == "70-74", 10, dat$AgeCategory)
dat$AgeCategory <- ifelse(dat$AgeCategory == "75-79", 11, dat$AgeCategory)
dat$AgeCategory <- ifelse(dat$AgeCategory == "80 or older", 12, dat$AgeCategory)
dat$Diabetic <- ifelse(dat$Diabetic == "No", 0, dat$Diabetic)
dat$Diabetic <- ifelse(dat$Diabetic == "No, borderline diabetes" | dat$Diabetic == "Yes (during pregnancy)", 0.5, dat$Diabetic)
dat$Diabetic <- ifelse(dat$Diabetic == "Yes", 1, dat$Diabetic)
dat$PhysicalActivity <- ifelse(dat$PhysicalActivity == "No", 0, dat$PhysicalActivity)
dat$PhysicalActivity <- ifelse(dat$PhysicalActivity == "Yes", 1, dat$PhysicalActivity)
dat$GenHealth <- ifelse(dat$GenHealth == "Poor", 0, dat$GenHealth)
dat$GenHealth <- ifelse(dat$GenHealth == "Fair", 0.25, dat$GenHealth)
dat$GenHealth <- ifelse(dat$GenHealth == "Good", 0.5, dat$GenHealth)
dat$GenHealth <- ifelse(dat$GenHealth == "Very good", 0.75, dat$GenHealth)
dat$GenHealth <- ifelse(dat$GenHealth == "Excellent", 1, dat$GenHealth)
dat$Asthma <- ifelse(dat$Asthma == "No", 0, dat$Asthma)
dat$Asthma <- ifelse(dat$Asthma == "Yes", 1, dat$Asthma)
dat$KidneyDisease <- ifelse(dat$KidneyDisease == "No", 0, dat$KidneyDisease)
dat$KidneyDisease <- ifelse(dat$KidneyDisease == "Yes", 1, dat$KidneyDisease)
dat$SkinCancer <- ifelse(dat$SkinCancer == "No", 0, dat$SkinCancer)
dat$SkinCancer <- ifelse(dat$SkinCancer == "Yes", 1, dat$SkinCancer)
cleanData <- subset(dat, select = -c(AlcoholDrinking))
trainingSet <- cleanData %>% filter(row(cleanData) >= 1 & row(cleanData) <= 200000)
testingSet <- cleanData %>% filter(row(cleanData) >= 200001 & row(cleanData) <= 301717)
clusters <- kmeans(x=trainingSet, centers=2, nstart = 1000)
print(clusters)
View(trainingSet)
trainingInitialCenters <- trainingSet[c(1, 271), ]
clusters <- kmeans(x=trainingSet, centers=trainingInitialCenters, nstart = 1000)
print(clusters)
trainingInitialCenters <- trainingSet[c(1, 271), ]
clusters <- kmeans(x=trainingSet, centers=12, nstart = 1000)
print(clusters)
trainingInitialCenters <- trainingSet[c(1, 271), ]
clusters <- kmeans(x=trainingSet, centers=2, nstart = 1000)
trainingInitialCenters <- trainingSet[c(1, 271), ]
<- kmeans(x=trainingSet, centers=2, nstart = 1000)
trainingInitialCenters <- trainingSet[c(1, 271), ]
clusters <- kmeans(x=trainingSet, centers=2, nstart = 1000)
print(clusters)
table(clusters$cluster, trainingSet$HeartDisease)
trainingInitialCenters <- trainingSet[c(1, 271), ]
clusters <- kmeans(x=trainingSet, centers=trainingInitialCenters, nstart = 1000)
print(clusters)
table(clusters$cluster, trainingSet$HeartDisease)
trainingInitialCenters <- trainingSet[c(8, 271), ]
clusters <- kmeans(x=trainingSet, centers=trainingInitialCenters, nstart = 1000)
print(clusters)
table(clusters$cluster, trainingSet$HeartDisease)
trainingInitialCenters <- trainingSet[c(20, 271), ]
clusters <- kmeans(x=trainingSet, centers=trainingInitialCenters, nstart = 1000)
print(clusters)
table(clusters$cluster, trainingSet$HeartDisease)
table(clusters$cluster, trainingSet$HeartDisease)
cleanData <- subset(dat, select = -c())
cleanData <- dat
#cleanData <- subset(dat, select = -c(AlcoholDrinking))
trainingSet <- cleanData %>% filter(row(cleanData) >= 1 & row(cleanData) <= 200000)
testingSet <- cleanData %>% filter(row(cleanData) >= 200001 & row(cleanData) <= 301717)
trainingInitialCenters <- trainingSet[c(20, 271), ]
clusters <- kmeans(x=trainingSet, centers=trainingInitialCenters, nstart = 1000)
print(clusters)
table(clusters$cluster, trainingSet$HeartDisease)
trainingInitialCenters <- trainingSet[c(20, 46), ]
clusters <- kmeans(x=trainingSet, centers=trainingInitialCenters, nstart = 1000)
print(clusters)
table(clusters$cluster, trainingSet$HeartDisease)
trainingInitialCenters <- trainingSet[c(20, 46), ]
clusters <- kmeans(x=trainingSet, centers=2, nstart = 200000)
trainingInitialCenters <- trainingSet[c(20, 46), ]
clusters <- kmeans(x=trainingSet, centers=2, nstart = 50000)
print(clusters)
table(clusters$cluster, trainingSet$HeartDisease)
